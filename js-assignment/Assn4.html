<!DOCTYPE html>
<html lang="en">
<head>
</head>
<body>
    <form>
        <label for='name' >Name : </label>
        <input type='text' name='name' class='name'/>
        <label for='email' >Email : </label>
        <input type='email' name='email' class='email' />
    </form>
    <br>
    <button class='submit-btn' >SUBMIT</button>
    <button class='display-btn' >SHOW USERS</button>
    <p class='err-msg' ></p>
</body>

<script>
    let body = document.querySelector('body');
    let submitbtn = document.querySelector('.submit-btn');
    let displaybtn = document.querySelector('.display-btn');
    let namevalue = document.querySelector('.name');
    let emailvalue = document.querySelector('.email');
    let form = document.querySelector('form');
    let errmsg = document.querySelector('.err-msg')
    
    submitbtn.addEventListener( 'click', ()=>{
    if( namevalue.value == "" || emailvalue.value == "" )
    {
        errmsg.innerText = 'Invalid Inputs';
        setTimeout(() => {
            errmsg.innerText = '';
        }, 2000);
        body.appendChild(err);
    }
    else{
        if( sessionStorage.length == 0 )
        {
            sessionStorage.setItem( "name", namevalue.value );
            sessionStorage.setItem( "email", emailvalue.value );
            sessionStorage.setItem( "time", new Date() );
        }
        else
        {
            sessionStorage.setItem( "name", sessionStorage.getItem("name") + "," +namevalue.value );
            sessionStorage.setItem( "email", sessionStorage.getItem("email") + "," +emailvalue.value );
            sessionStorage.setItem( "time", sessionStorage.getItem("time") + "," +new Date());
        }
    }
} )

displaybtn.addEventListener('click', ()=>{
    
    let t = document.querySelector('table');

    console.log( sessionStorage.length )
    if(t)
    {
        t.remove();
    }
    let table = document.createElement('table');
    table.classList.add('.table')
    table.innerHTML = `<tr>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Date</th>
                        </tr>`
    if( sessionStorage.length > 1 )
    {
        let names = sessionStorage.getItem('name').split(",");
        let emails = sessionStorage.getItem('email').split(",");
        let dates = sessionStorage.getItem('time').split(",");
    
        for( let i=0; i<names.length; ++i )
        {
            let row = document.createElement('tr');
            row.innerHTML = `<td>${names[i]}</td>
                            <td>${emails[i]}</td>
                            <td>${dates[i]}</td>`;
            table.appendChild(row);
        }
    }

    body.appendChild(table);
})
</script>
</html>